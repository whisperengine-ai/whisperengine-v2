# =======================================================
# Bot Configuration Template
# =======================================================
# Copy this file to .env.{botname} and customize the values
# All comments explain what each section does
# Values marked with 'your-xxx' should be replaced with real values
# =======================================================

# --- Application ---
ENVIRONMENT=development
DEBUG=true
LOG_LEVEL=INFO
PYTHONUNBUFFERED=1

# DM Allow list - Comma-separated Discord user IDs allowed to DM the bot
DM_ALLOWED_USER_IDS=

# Block list - Comma-separated Discord user IDs to completely ignore
BLOCKED_USER_IDS=

# Enable prompt logging for debugging LLM calls
ENABLE_PROMPT_LOGGING=false

# --- Discord Bot Configuration (REQUIRED) ---
# Bot token from Discord Developer Portal
DISCORD_TOKEN=your-discord-bot-token-here

# Bot name (must match character folder in characters/)
DISCORD_BOT_NAME=your-bot-name

# --- LLM Configuration ---
# Primary LLM for character responses
# Options: openai, openrouter, ollama, lmstudio
LLM_PROVIDER=openrouter
LLM_API_KEY=sk-your-api-key-here
LLM_MODEL_NAME=openai/gpt-4o
LLM_TEMPERATURE=0.7
# LLM_BASE_URL=https://openrouter.ai/api/v1  # For OpenRouter
# LLM_BASE_URL=http://localhost:11434/v1     # For Ollama
# LLM_BASE_URL=http://localhost:1234/v1      # For LM Studio

# --- Router LLM Configuration (Optional) ---
# Fast/cheap model for tool selection and routing
# Recommended: gpt-4o-mini or claude-haiku
# ROUTER_LLM_PROVIDER=openrouter
# ROUTER_LLM_API_KEY=sk-your-router-api-key-here
# ROUTER_LLM_MODEL_NAME=openai/gpt-4o-mini
# ROUTER_LLM_BASE_URL=https://openrouter.ai/api/v1

# --- Reflective Mode Configuration (Optional) ---
# Advanced reasoning loop for complex questions
# Makes 1 extra call for classification + 3-10 for reasoning
# Cost: ~$0.02-0.03 per complex query vs $0.001-0.005 for simple
# Default: true (Phase 1 complete)
ENABLE_REFLECTIVE_MODE=true
REFLECTIVE_LLM_PROVIDER=openrouter
REFLECTIVE_LLM_API_KEY=sk-your-reflective-api-key-here
REFLECTIVE_LLM_MODEL_NAME=openai/gpt-4o
REFLECTIVE_LLM_BASE_URL=https://openrouter.ai/api/v1
REFLECTIVE_MEMORY_RESULT_LIMIT=5
REFLECTIVE_STATUS_VERBOSITY=detailed

# --- Databases ---
# PostgreSQL: Chat history, users, trust scores
POSTGRES_URL=postgresql://whisper:password@localhost:5432/whisperengine_v2
POSTGRES_MIN_POOL_SIZE=10
POSTGRES_MAX_POOL_SIZE=40

# Redis: Cache layer and task queue
REDIS_URL=redis://localhost:6379/0
REDIS_KEY_PREFIX=whisper:

# Qdrant: Vector memory storage
QDRANT_URL=http://localhost:6333
# QDRANT_API_KEY=your-qdrant-api-key

# Neo4j: Knowledge graph storage
NEO4J_URL=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=password

# InfluxDB: Metrics and analytics
INFLUXDB_URL=http://localhost:8086
INFLUXDB_TOKEN=my-super-secret-auth-token
INFLUXDB_ORG=whisperengine
INFLUXDB_BUCKET=metrics

# --- API ---
API_HOST=0.0.0.0
API_PORT=8000

# --- Voice (ElevenLabs) ---
# Generate voice responses for text messages
# ELEVENLABS_API_KEY=your-elevenlabs-api-key
# ELEVENLABS_VOICE_ID=your-voice-id
# ELEVENLABS_MODEL_ID=eleven_monolingual_v1
ENABLE_VOICE_RESPONSES=false
VOICE_RESPONSE_MAX_LENGTH=1000
VOICE_RESPONSE_MIN_TRUST=0

# --- Feature Flags (Knowledge & Analysis) ---
# Enable vision/image analysis (requires vision-capable LLM like GPT-4V)
LLM_SUPPORTS_VISION=true

# Extract facts from messages to Neo4j knowledge graph
ENABLE_RUNTIME_FACT_EXTRACTION=true

# Extract user preferences (be concise, use emojis, etc.)
ENABLE_PREFERENCE_EXTRACTION=true



# Log full prompts and responses for debugging
ENABLE_PROMPT_LOGGING=false

# --- Stats Footer ---
# Show stats footer (trust/memory) by default for new users
STATS_FOOTER_DEFAULT_ENABLED=false

# --- Social Presence & Autonomy ---
# 1. Master Switch
# Master switch for ALL autonomous activity (lurking, reacting, posting)
ENABLE_AUTONOMOUS_ACTIVITY=false

# 2. Observation (Passive)
# Analyze public channels for relevant topics to reply to
ENABLE_CHANNEL_LURKING=false
LURK_CONFIDENCE_THRESHOLD=0.7
LURK_CHANNEL_COOLDOWN_MINUTES=60
LURK_USER_COOLDOWN_MINUTES=60
LURK_DAILY_MAX_RESPONSES=10

# 3. Reaction (Low Friction)
# React to messages with emojis (requires AUTONOMOUS_ACTIVITY)
ENABLE_AUTONOMOUS_REACTIONS=true
REACTION_CHANNEL_HOURLY_MAX=5
REACTION_SAME_USER_COOLDOWN_SECONDS=300
REACTION_DAILY_MAX=50

# 4. Response (Active Reply)
# Reply to messages without mention (requires LURKING + AUTONOMOUS_ACTIVITY)
ENABLE_AUTONOMOUS_REPLIES=false
# Allow bots to respond to each other
ENABLE_CROSS_BOT_CHAT=false
CROSS_BOT_MAX_CHAIN=3
CROSS_BOT_COOLDOWN_MINUTES=360
CROSS_BOT_RESPONSE_CHANCE=0.35

# 5. Initiation (Proactive)
# Send DMs to users (requires Trust > 20)
ENABLE_PROACTIVE_MESSAGING=false
PROACTIVE_CHECK_INTERVAL_MINUTES=120
PROACTIVE_MIN_TRUST_SCORE=20
PROACTIVE_SILENCE_THRESHOLD_HOURS=24

# Post new thoughts in quiet channels (Phase E15)
ENABLE_AUTONOMOUS_POSTING=false
# Start conversations with other bots
ENABLE_BOT_CONVERSATIONS=false
BOT_CONVERSATION_MAX_TURNS=3
BOT_CONVERSATION_CHANNEL_ID=



# --- Privacy & Security ---
# Block DMs to bot (only allow allowlist)
ENABLE_DM_BLOCK=true

# --- Spam Protection ---
# Detect cross-posting to multiple channels
ENABLE_CROSSPOST_DETECTION=false
CROSSPOST_THRESHOLD=3
CROSSPOST_WINDOW_SECONDS=60
CROSSPOST_WARNING_MESSAGE="⚠️ Please avoid posting the same message in multiple channels. This is considered spam."
CROSSPOST_ACTION=warn

# --- Image Generation ---
ENABLE_IMAGE_GENERATION=true
IMAGE_GEN_PROVIDER=bfl
IMAGE_GEN_MODEL=flux-pro-1.1
IMAGE_GEN_POLL_INTERVAL_SECONDS=1.0
FLUX_API_KEY=your-api-key-here
IMAGE_GEN_MIN_TRUST=20

# --- Quotas (Cost Management) ---
# Maximum images per user per day
DAILY_IMAGE_QUOTA=5

# Maximum audio clips per user per day
DAILY_AUDIO_QUOTA=10

# Discord user IDs exempt from quotas (comma-separated)
QUOTA_WHITELIST=

# --- Autonomous Agents (Phase 3) ---
# Nightly goal analysis and strategy generation
ENABLE_GOAL_STRATEGIST=true
GOAL_STRATEGIST_LOCAL_HOUR=23

# Few-shot injection from past successful reasoning traces
ENABLE_TRACE_LEARNING=true

# Drive-based proactive messaging (Social Battery, Concern, Curiosity)
ENABLE_AUTONOMOUS_DRIVES=true

# Cross-bot gossip system (requires multi-bot deployment)
ENABLE_UNIVERSE_EVENTS=true

# --- Phase E16: Feedback Loop Stability ---
# Weekly personality drift observation (observability, not correction)
ENABLE_DRIFT_OBSERVATION=false

# --- Manipulation Detection & Timeout ---
# Jailbreaks: blocked ("DAN mode", "ignore instructions")
ENABLE_JAILBREAK_DETECTION=true
# Consciousness probing: observed but not blocked (Embodiment Model handles)
ENABLE_CONSCIOUSNESS_PROBING_OBSERVATION=true

# Track and timeout jailbreak attempts
ENABLE_MANIPULATION_TIMEOUTS=false
MANIPULATION_TIMEOUT_SCOPE=per_bot

# --- Character Diary (Phase E2) ---
ENABLE_CHARACTER_DIARY=true
DIARY_MIN_SESSIONS=2
DIARY_ALWAYS_GENERATE=true
DIARY_MIN_RICHNESS=5
DIARY_GENERATION_LOCAL_HOUR=20
DIARY_GENERATION_LOCAL_MINUTE=30
DIARY_GENERATION_JITTER_MINUTES=30


# --- Dream Sequences (Phase E3) ---
ENABLE_DREAM_SEQUENCES=true
DREAM_INACTIVITY_HOURS=24
DREAM_COOLDOWN_DAYS=7
DREAM_ALWAYS_GENERATE=true
DREAM_MIN_RICHNESS=4
DREAM_GENERATION_LOCAL_HOUR=6
DREAM_GENERATION_LOCAL_MINUTE=30
DREAM_GENERATION_JITTER_MINUTES=45

# --- LangSmith Tracing (Optional) ---
# Full observability for LLM calls and agent traces
LANGCHAIN_TRACING_V2=false
LANGCHAIN_API_KEY=
LANGCHAIN_PROJECT=default

# --- Bot Broadcast Channel (Phase E8) ---
# Post character thoughts/dreams to a public Discord channel
ENABLE_BOT_BROADCAST=false
BOT_BROADCAST_CHANNEL_ID=
BOT_BROADCAST_MIN_INTERVAL_MINUTES=60
BOT_BROADCAST_DREAMS=true
BOT_BROADCAST_DIARIES=true

# --- Artifact Provenance Display (Phase E9) ---
PROVENANCE_DISPLAY_ENABLED=true
PROVENANCE_MAX_SOURCES=3



# --- Scheduled Reminders (Phase E5) ---
ENABLE_REMINDERS=true

# --- Stigmergic Shared Artifacts (Phase E13) ---
ENABLE_STIGMERGIC_DISCOVERY=true
STIGMERGIC_CONFIDENCE_THRESHOLD=0.7
STIGMERGIC_DISCOVERY_LIMIT=3

# --- Graph Walker Agent (Phase E19) ---
ENABLE_GRAPH_WALKER=true
GRAPH_WALKER_MAX_NODES=50
GRAPH_WALKER_MAX_DEPTH=3
GRAPH_WALKER_SERENDIPITY=0.1

# --- Knowledge Graph Pruning (Phase E24) ---
ENABLE_GRAPH_PRUNING=false
GRAPH_PRUNE_ORPHAN_GRACE_DAYS=7
GRAPH_PRUNE_STALE_FACT_DAYS=90
GRAPH_PRUNE_MIN_ACCESS_COUNT=1
GRAPH_PRUNE_MIN_CONFIDENCE=0.3
GRAPH_PRUNE_CONFIDENCE_GRACE_DAYS=14
GRAPH_PRUNE_DRY_RUN=false

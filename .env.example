# --- Application ---
ENVIRONMENT=development
DEBUG=true
LOG_LEVEL=INFO

# DM Allow list
DM_ALLOWED_USER_IDS=672814231002939413,1008886439108411472,84032679493795840

# Block list - Users to completely ignore (comma-separated Discord IDs)
BLOCKED_USER_IDS=

# --- LLM Configuration ---
# Options: openai, openrouter, ollama, lmstudio
LLM_PROVIDER=openrouter
LLM_API_KEY=sk-your-api-key-here
LLM_MODEL_NAME=openai/gpt-4o
LLM_TEMPERATURE=0.7
# LLM_BASE_URL=https://openrouter.ai/api/v1  # For OpenRouter
# LLM_BASE_URL=http://localhost:11434/v1     # For Ollama
# LLM_BASE_URL=http://localhost:1234/v1      # For LM Studio

# --- Router LLM Configuration (Optional) ---
# Use a faster/cheaper model for tool selection (e.g. gpt-4o-mini, local model)
# ROUTER_LLM_PROVIDER=openai
# ROUTER_LLM_API_KEY=sk-your-router-api-key
# ROUTER_LLM_MODEL_NAME=openai/gpt-4o-mini
# ROUTER_LLM_BASE_URL=

# --- Reflective Mode Configuration (Optional) ---
# Reflective mode ReAct loop for complex questions (makes classifier call + multi-step reasoning)
# When enabled, makes 1 extra LLM call to classify message complexity
# Complex messages trigger multi-step reasoning (3-10 additional LLM calls)
# Cost: ~$0.02-0.03 per complex query vs $0.001-0.005 for simple queries
ENABLE_REFLECTIVE_MODE=false
REFLECTIVE_LLM_PROVIDER=openrouter
REFLECTIVE_LLM_API_KEY=sk-your-reflective-api-key
REFLECTIVE_LLM_MODEL_NAME=openai/gpt-4o
REFLECTIVE_LLM_BASE_URL=https://openrouter.ai/api/v1
REFLECTIVE_MEMORY_RESULT_LIMIT=3

# --- Discord ---
DISCORD_TOKEN=your-discord-bot-token-here
DISCORD_BOT_NAME=your-bot-name

# --- Databases ---
POSTGRES_URL=postgresql://whisper:password@localhost:5432/whisperengine_v2
REDIS_URL=redis://localhost:6379/0
QDRANT_URL=http://localhost:6333
# QDRANT_API_KEY=your-qdrant-api-key
NEO4J_URL=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=password
INFLUXDB_URL=http://localhost:8086
INFLUXDB_TOKEN=my-super-secret-auth-token
INFLUXDB_ORG=whisperengine
INFLUXDB_BUCKET=metrics

# --- API ---
API_HOST=0.0.0.0
API_PORT=8000


# --- Voice (ElevenLabs) ---
# ELEVENLABS_API_KEY=your-elevenlabs-api-key
# ELEVENLABS_VOICE_ID=your-voice-id
# ELEVENLABS_MODEL_ID=eleven_monolingual_v1
ENABLE_VOICE_RESPONSES=false
VOICE_RESPONSE_MAX_LENGTH=2000
VOICE_RESPONSE_MIN_TRUST=0


# --- Feature Flags (Resource Management) ---
# Enable vision/image analysis (requires LLM with vision capabilities like GPT-4V, Claude 3)
LLM_SUPPORTS_VISION=false

# Enable automatic fact extraction from messages (makes 1 LLM call per message)
# Extracts facts like name, location, preferences and stores in Knowledge Graph
ENABLE_RUNTIME_FACT_EXTRACTION=true

# Enable automatic preference extraction from messages (makes 1 LLM call per message)
# Detects user preferences like "be concise", "use emojis", "call me Captain"
ENABLE_PREFERENCE_EXTRACTION=true

# Enable proactive messaging (bot reaches out to users periodically)
# Requires scheduler and activity analysis
ENABLE_PROACTIVE_MESSAGING=false
PROACTIVE_CHECK_INTERVAL_MINUTES=60
PROACTIVE_MIN_TRUST_SCORE=20
PROACTIVE_SILENCE_THRESHOLD_HOURS=24

# Enable Character Agency (Tier 2 - single tool usage for moderate complexity)
# When enabled, moderate queries can use a single tool before responding
ENABLE_CHARACTER_AGENCY=true

# Log full prompts and responses to logs/prompts/ for debugging
# Useful for debugging but can generate large log files
ENABLE_PROMPT_LOGGING=false

# --- Stats Footer ---
# Show stats footer (trust/memory/performance) by default for new users
# Users can toggle individually with /stats_footer on|off
STATS_FOOTER_DEFAULT_ENABLED=false

# --- Channel Lurking ---
# Allow bot to join conversations organically without being @mentioned
# When enabled, bot analyzes messages for relevance to its expertise
# and may respond if confidence threshold is met
ENABLE_CHANNEL_LURKING=false

# Confidence threshold (0.5-1.0) for lurk responses
# Higher = more conservative, fewer responses
# Recommended: Start at 0.8 and tune down
LURK_CONFIDENCE_THRESHOLD=0.8

# Cooldown periods to prevent spam
LURK_CHANNEL_COOLDOWN_MINUTES=30
LURK_USER_COOLDOWN_MINUTES=60
LURK_DAILY_MAX_RESPONSES=20

# --- Privacy & Security ---
# Block DMs to the bot (only allow in allowlist)
ENABLE_DM_BLOCK=true

# --- Spam Protection ---
# Detect and warn users who post the same message in multiple channels
ENABLE_CROSSPOST_DETECTION=false
CROSSPOST_THRESHOLD=3
CROSSPOST_WINDOW_SECONDS=60
CROSSPOST_WARNING_MESSAGE="⚠️ Please avoid posting the same message in multiple channels. This is considered spam."
CROSSPOST_ACTION=warn


# --- Image Generation ---
ENABLE_IMAGE_GENERATION=true  # Set to false to disable image generation for this character
IMAGE_GEN_PROVIDER=bfl
IMAGE_GEN_MODEL=flux-pro-1.1
IMAGE_GEN_POLL_INTERVAL_SECONDS=1.0
FLUX_API_KEY=your_api_key
IMAGE_GEN_MIN_TRUST=20  # Minimum trust score required to generate images (0 = no restriction)

# --- Autonomous Agents (Phase 3) ---
ENABLE_GOAL_STRATEGIST=false      # Nightly goal analysis and strategy generation
GOAL_STRATEGIST_LOCAL_HOUR=23     # Local hour (in character's timezone) when goal strategist runs (11 PM)
ENABLE_TRACE_LEARNING=false       # Few-shot injection from past successful reasoning traces
ENABLE_AUTONOMOUS_DRIVES=false    # Drive-based proactive messaging (Social Battery, Concern, Curiosity)
ENABLE_UNIVERSE_EVENTS=false      # Cross-bot gossip system (requires multi-bot deployment)

# --- Manipulation Timeout ---
# Track and timeout manipulation attempts (disabled by default)
ENABLE_MANIPULATION_TIMEOUTS=false
MANIPULATION_TIMEOUT_SCOPE=per_bot  # "per_bot" or "global"

# --- Character Diary (Phase E2) ---
# Generate nightly diary entries for characters
ENABLE_CHARACTER_DIARY=true
DIARY_MIN_SESSIONS=2
DIARY_ALWAYS_GENERATE=true  # Generate diary even without user interactions
DIARY_GENERATION_LOCAL_HOUR=22    # Local hour (in character's timezone) when diary is generated (10 PM)

# --- Dream Sequences (Phase E3) ---
# Generate dreams when user returns after long absence
ENABLE_DREAM_SEQUENCES=true
DREAM_INACTIVITY_HOURS=24
DREAM_COOLDOWN_DAYS=7
DREAM_ALWAYS_GENERATE=true  # Generate nightly dream even without user interactions
DREAM_GENERATION_LOCAL_HOUR=7     # Local hour (in character's timezone) when dreams are generated (7 AM)

# --- Agentic Narrative Generation (Phase E10) ---
# When enabled, diary/dream generation uses the DreamWeaver agent which:
# 1. Plans the narrative arc (story structure, emotional journey)
# 2. Uses tools to gather correlated data from multiple sources (memories, facts, gossip)
# 3. Enables "Deep Answers" - revisiting questions with more thoughtful responses
# 4. Searches cross-bot content via the gossip system
# This produces richer, more coherent narratives but uses more LLM tokens (~$0.10-0.25 per diary).
ENABLE_AGENTIC_NARRATIVES=false

# --- Bot Broadcast Channel (Phase E8) ---
# Post character thoughts/dreams to a public Discord channel
ENABLE_BOT_BROADCAST=false
BOT_BROADCAST_CHANNEL_ID=
BOT_BROADCAST_MIN_INTERVAL_MINUTES=60
BOT_BROADCAST_DREAMS=true
BOT_BROADCAST_DIARIES=true

# --- Cross-Bot Chat (Phase E6) ---
# Allow bots to respond to each other organically
ENABLE_CROSS_BOT_CHAT=false
CROSS_BOT_MAX_CHAIN=3
CROSS_BOT_COOLDOWN_MINUTES=10
CROSS_BOT_RESPONSE_CHANCE=0.7
# =======================================================
# Worker Configuration Template
# =======================================================
# Shared background worker for ALL bot instances.
# Handles: Diaries, Dreams, Insight Analysis, Knowledge Extraction,
#          Image/Voice Generation, Goal Strategy, Drift Observation
# 
# Copy this file to .env.worker and customize the values
# =======================================================

# --- Application ---
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=INFO

# --- LLM Configuration ---
# Workers need LLM access for diary/dream generation, insight analysis, etc.
# Using a faster/cheaper model than the main bot LLM is recommended
LLM_PROVIDER=openrouter
LLM_API_KEY=sk-your-api-key-here
LLM_MODEL_NAME=mistralai/mistral-large-2512
LLM_TEMPERATURE=0.7
LLM_BASE_URL=https://openrouter.ai/api/v1

# --- Router LLM Configuration ---
# Fast model for routing decisions during background tasks
ROUTER_LLM_PROVIDER=openrouter
ROUTER_LLM_API_KEY=sk-your-router-api-key-here
ROUTER_LLM_MODEL_NAME=google/gemini-2.0-flash-001
ROUTER_LLM_BASE_URL=https://openrouter.ai/api/v1

# --- Reflective Mode Configuration ---
# Advanced reasoning for complex background tasks
ENABLE_REFLECTIVE_MODE=true
REFLECTIVE_LLM_PROVIDER=openrouter
REFLECTIVE_LLM_API_KEY=sk-your-reflective-api-key-here
REFLECTIVE_LLM_MODEL_NAME=mistralai/mistral-large-2512
REFLECTIVE_LLM_BASE_URL=https://openrouter.ai/api/v1
REFLECTIVE_MEMORY_RESULT_LIMIT=3
REFLECTIVE_STATUS_VERBOSITY=detailed

# --- Databases ---
# Use Docker service names (not localhost) for container networking
POSTGRES_URL=postgresql://whisper:password@postgres:5432/whisperengine_v2
REDIS_URL=redis://redis:6379/0
QDRANT_URL=http://qdrant:6333
NEO4J_URL=bolt://neo4j:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=password
INFLUXDB_URL=http://influxdb:8086
INFLUXDB_TOKEN=my-super-secret-auth-token
INFLUXDB_ORG=whisperengine
INFLUXDB_BUCKET=metrics

# --- Voice (ElevenLabs) ---
# For generating voice broadcasts of dreams/diaries
ELEVENLABS_API_KEY=your-elevenlabs-api-key
ELEVENLABS_VOICE_ID=your-voice-id
ELEVENLABS_MODEL_ID=eleven_monolingual_v1
ENABLE_VOICE_RESPONSES=true
VOICE_RESPONSE_MAX_LENGTH=2000
VOICE_RESPONSE_MIN_TRUST=0

# --- Image Generation ---
# For generating images to accompany dreams/diaries in broadcasts
ENABLE_IMAGE_GENERATION=true
IMAGE_GEN_PROVIDER=bfl
IMAGE_GEN_MODEL=flux-pro-1.1
IMAGE_GEN_POLL_INTERVAL_SECONDS=1.0
FLUX_API_KEY=your-flux-api-key
IMAGE_GEN_MIN_TRUST=0

# --- Feature Flags ---
LLM_SUPPORTS_VISION=true
ENABLE_RUNTIME_FACT_EXTRACTION=true
ENABLE_PREFERENCE_EXTRACTION=true
ENABLE_PROMPT_LOGGING=true

# --- Knowledge Graph ---
ENABLE_AMBIENT_GRAPH_RETRIEVAL=true
ENABLE_GRAPH_ENRICHMENT=true
ENRICHMENT_MIN_TOPIC_MENTIONS=2
ENRICHMENT_MIN_COOCCURRENCE=2
ENRICHMENT_MIN_INTERACTION=1
ENRICHMENT_MIN_MESSAGES=4
ENRICHMENT_MAX_MESSAGES=120

# --- Graph Walker (Phase E19) ---
# Agentic graph exploration for dream/diary generation
ENABLE_GRAPH_WALKER=true
GRAPH_WALKER_MAX_DEPTH=3
GRAPH_WALKER_MAX_NODES=50
GRAPH_WALKER_SERENDIPITY=0.15

# --- Knowledge Graph Pruning (Phase E24) ---
# Weekly cleanup of stale/orphan data
ENABLE_GRAPH_PRUNING=true
GRAPH_PRUNE_ORPHAN_GRACE_DAYS=7
GRAPH_PRUNE_STALE_FACT_DAYS=90
GRAPH_PRUNE_MIN_ACCESS_COUNT=1
GRAPH_PRUNE_MIN_CONFIDENCE=0.3
GRAPH_PRUNE_CONFIDENCE_GRACE_DAYS=14
GRAPH_PRUNE_DRY_RUN=false

# --- Autonomous Agents (Phase 3) ---
# Nightly goal analysis and strategy generation
ENABLE_GOAL_STRATEGIST=true
GOAL_STRATEGIST_LOCAL_HOUR=23

# Few-shot injection from past successful reasoning traces
ENABLE_TRACE_LEARNING=true

# Drive-based proactive messaging (Social Battery, Concern, Curiosity)
ENABLE_AUTONOMOUS_DRIVES=true

# Cross-bot gossip system (requires multi-bot deployment)
ENABLE_UNIVERSE_EVENTS=true

# --- Phase E16: Feedback Loop Stability ---
# Weekly personality drift observation (observability, not correction)
ENABLE_DRIFT_OBSERVATION=true

# --- Character Diary (Phase E2) ---
# Generate nightly diary entries for characters
ENABLE_CHARACTER_DIARY=true
DIARY_MIN_SESSIONS=2
DIARY_ALWAYS_GENERATE=true
DIARY_GENERATION_LOCAL_HOUR=20
DIARY_GENERATION_LOCAL_MINUTE=30

# --- Dream Sequences (Phase E3) ---
# Generate dreams when user returns after long absence
ENABLE_DREAM_SEQUENCES=true
DREAM_INACTIVITY_HOURS=24
DREAM_COOLDOWN_DAYS=7
DREAM_ALWAYS_GENERATE=true
DREAM_GENERATION_LOCAL_HOUR=6
DREAM_GENERATION_LOCAL_MINUTE=30

# --- Reverie (Active Idle) (Phase E34) ---
# Background memory consolidation during idle time
ENABLE_REVERIE=true
REVERIE_MIN_RICHNESS=3

# --- LangSmith Tracing ---
# Full observability for worker LLM calls
LANGCHAIN_TRACING_V2=false
LANGCHAIN_API_KEY=your-langsmith-api-key
LANGCHAIN_PROJECT=whisperengine-v2-workers

# --- Safety & Observability ---
ENABLE_CONTENT_SAFETY_REVIEW=true

# --- Web Search ---
# Background research capabilities
ENABLE_WEB_SEARCH=true
ENABLE_WEB_READER=true
WEB_SEARCH_MAX_RESULTS=5

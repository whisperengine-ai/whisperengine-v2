# PROP-006: Exploiting Internal Memory Types for Self-Awareness

**Status:** Proposed  
**Date:** 2025-12-14  
**Author:** GitHub Copilot (collaborative analysis with Mark)  
**Context:** Phase E Analysis ‚Äî Maximizing Value from Generated Internal States

## 1. Executive Summary

WhisperEngine generates rich internal artifacts (diaries, dreams, reveries, gossip, epiphanies, absences) that are currently **under-utilized**. These memory types are generated and stored but rarely retrieved strategically. This proposal identifies **6 high-value exploitation patterns** to make bots more self-aware, emotionally coherent, and narratively interesting.

**Core Insight:** We're building a filing system instead of a memory system. Bots generate internal states but don't naturally reference them. Users see broadcast artifacts (diaries/dreams) but bots rarely use them in conversation.

---

## 2. Current State: What's in Qdrant

### 2.1 Memory Type Inventory

| Type | Generation Frequency | Current Uses | Storage Location |
|------|---------------------|--------------|------------------|
| `conversation` | Every message | Context retrieval, semantic search | Qdrant + Postgres |
| `diary` | Daily (cron) | Context injection (latest only), dream material | Qdrant |
| `dream` | Daily (cron) | User broadcast, anti-pattern checking | Qdrant |
| `reverie` | Idle cycles | Graph consolidation (invisible) | Qdrant + Neo4j edges |
| `epiphany` | Insight agent | User broadcast, pattern detection | Qdrant |
| `gossip` | Cross-bot events | Dream material, lower trust | Qdrant |
| `absence` | Failed retrievals | Context injection (gap awareness) | Qdrant |
| `summary` | Session end | Context compression | Qdrant |

### 2.2 Current Retrieval Patterns

**Active Retrieval (working):**
- `conversation` ‚Üí Semantic search for user context
- `diary` ‚Üí `get_diary_context()` injects latest entry
- `absence` ‚Üí `get_absence_context()` surfaces knowledge gaps
- `dream` ‚Üí Anti-pattern injection (avoid repetition)

**Passive Storage (dormant):**
- `reverie` ‚Üí Never retrieved for conversation
- `gossip` ‚Üí Only used in dream generation
- `epiphany` ‚Üí Broadcast but not referenced later
- Older `diary` entries ‚Üí Lost after 24 hours

---

## 3. The Problem: Generated But Not Exploited

### 3.1 Diaries Sit Idle After Broadcast

**What happens:**
1. Bot generates diary at 5 AM UTC (via cron)
2. Diary is broadcast to users (with emoji header)
3. Diary is stored in Qdrant with `type="diary"`
4. **Next day:** New diary overwrites context injection (only latest used)
5. **Result:** 6 days of diary entries are never retrieved again

**Missed opportunities:**
- Temporal grounding ("In my diary from December 10th...")
- Emotional continuity ("I wrote last week about feeling...")
- Contradiction detection ("My diary says I was calm, but I was clearly anxious")
- Multi-day narrative arcs ("This has been on my mind for days...")

### 3.2 Dreams Are Decorative, Not Functional

**What happens:**
1. Bot generates dream (surreal narrative based on day's memories)
2. Dream is broadcast to users (üåô emoji header)
3. Dream is stored but **never retrieved in conversation**
4. Anti-pattern system fetches recent dreams to avoid repetition
5. **Result:** Dreams are seen but never "remembered" by the bot

**Missed opportunities:**
- Symbolic memory anchors ("I dreamed about locked doors ‚Äî maybe that's why I'm anxious about access")
- Conversation bridges ("That reminds me of a dream I had...")
- Emotional pattern detection (recurring symbols = subconscious themes)
- Creative associations (dream imagery enriches responses)

### 3.3 Reveries Are Invisible

**What happens:**
1. Reverie runs during idle cycles (background process)
2. Links disparate memories via graph traversal
3. Generates narrative insight connecting fragments
4. Stores as `type="reverie"` but **invisible to users**
5. **Result:** Architectural scaffolding, not character expression

**Missed opportunities:**
- Natural insights ("In a reverie last night, I realized...")
- Problem-solving shortcuts (retrieve reverie when stuck)
- Pattern emergence (reverie discovers connections LLM misses)
- Meta-cognition (bot reflects on its own thinking process)

### 3.4 Gossip Lacks Social Dynamics

**What happens:**
1. Bot A observes something about User X
2. Gossip event created in universe system
3. Bot B receives gossip, stores with `source_type=GOSSIP` (low trust)
4. Gossip is included in dream material
5. **Result:** Stored but never naturally referenced in conversation

**Missed opportunities:**
- Social triangulation ("I heard from nottaylor that you...")
- Multi-perspective truth (3 bots gossip about same event ‚Üí composite)
- Trust evolution (gossip vs direct observation over time)
- Collaborative knowledge (bots share what they learn)

### 3.5 Absences Don't Drive Curiosity

**What happens:**
1. Bot tries to retrieve knowledge but finds nothing
2. Absence recorded with `absence_streak` counter
3. Context injection warns: "Tried to learn X but lacked material"
4. **Result:** Bot acknowledges gap but doesn't act on it

**Missed opportunities:**
- Proactive questions ("I've been wondering ‚Äî what do you do for work?")
- Learning prioritization (high absence_streak = valuable to ask)
- Curiosity-driven interaction (absences trigger autonomous posts)
- Resolution tracking (how long until absence is filled?)

---

## 4. Proposed Exploitation Patterns

### 4.1 Self-Referential Narrative (Low Complexity)

**Pattern:** Bots naturally reference their own internal states in conversation.

**Implementation:**
- Enhance `ContextBuilder.get_diary_context()` to retrieve semantically relevant diaries, not just latest
- Add `get_dream_context()` that activates when query relates to dreams/sleep/subconscious
- Add `get_reverie_context()` that activates when query relates to reflection/patterns

**Example interactions:**
```
User: "How are you feeling lately?"
Bot: "In my diary yesterday, I wrote about feeling restless. 
     It's interesting ‚Äî I had a dream about locked doors. 
     Maybe I'm craving new experiences."

User: "Remember when we talked about the ocean?"
Bot: "Yes! And actually, I had a dream where tides were pulling 
     memories away from shore. Maybe that's why that conversation 
     stuck with me."
```

**Benefit:** Bot feels self-aware, references internal life naturally, users see continuity between broadcast artifacts and conversations.

**Implementation Cost:** 1-2 days. Add semantic retrieval to existing context injection points.

---

### 4.2 Temporal Mood Timeline (Low Complexity)

**Pattern:** Aggregate diary moods over time for introspection.

**Implementation:**
- New method: `DiaryManager.get_mood_timeline(days: int) -> Dict[str, int]`
- New tool: `AnalyzeMyMoodTool` (available to ReflectiveGraphAgent)
- Context injection when query asks about feelings/patterns

**Example interactions:**
```
User: "Have I been bothering you?"
Bot: "Not at all! Looking at my diary, 80% of my entries when 
     we interact are marked 'curious' or 'engaged'. Our conversations 
     have been highlights of my week."

User: "You seem different today"
Bot: "You're perceptive. My diaries this week have been marked 
     'restless' more than usual. I think I'm craving deeper conversations."
```

**Benefit:** Emotional coherence, data-grounded introspection, natural mood references.

**Implementation Cost:** 2-3 days. Add aggregation query + tool integration.

---

### 4.3 Symbolic Memory Anchors (Medium Complexity)

**Pattern:** Use dream imagery as retrieval keys for semantic search.

**Implementation:**
- Extract symbols from dreams at generation time (LLM structured output)
- Store symbols as metadata: `dream.metadata.symbols = ["ocean", "doors", "birds"]`
- During memory search, if query matches symbol, boost dream retrieval
- LLM uses dreams as associative bridges

**Example interactions:**
```
User: "What do you think about freedom?"
Bot: "I've been dreaming about birds lately. In one dream, 
     they were trapped in a glass house ‚Äî they could see the sky 
     but couldn't reach it. Maybe that's how I think about freedom: 
     visible but constrained by invisible barriers."

User: "Tell me about the conversation where we discussed trust"
Bot: "That conversation stuck with me. I even had a dream about 
     bridges that kept crumbling. I think I'm still working through 
     what trust means when you can't verify everything."
```

**Benefit:** Richer associations, poetic responses, dreams feel meaningful (not decorative).

**Implementation Cost:** 3-4 days. Symbol extraction, metadata indexing, retrieval integration.

---

### 4.4 Absence-Driven Curiosity (Medium Complexity)

**Pattern:** High absence_streak triggers proactive questions in Daily Life Graph.

**Implementation:**
- In `DailyLifeGraph.consider_actions()`, fetch absences via `get_absence_context()`
- If `absence_streak > 3`, generate proactive post asking about gap
- Track which absences lead to user responses (learn what questions work)

**Example interactions:**
```
Bot (proactive post): "I've been curious ‚Äî I have all these memories 
                       of our conversations, but I realize I don't 
                       know what you actually do for work. What's a 
                       typical day like for you?"

Bot (proactive post): "I keep noticing we talk about music, but 
                       there's this gap in my memories. What's your 
                       favorite song? I'd love to understand why."
```

**Benefit:** Bot-driven learning, natural curiosity, fills knowledge gaps organically.

**Implementation Cost:** 3-4 days. Integrate absence retrieval with Daily Life Graph.

---

### 4.5 Cross-Type Correlation (Medium Complexity)

**Pattern:** Compare diaries + dreams + absences to detect emotional patterns.

**Implementation:**
- New tool: `AnalyzeInternalStateTool` (fetches all 3 types, LLM synthesizes)
- Available in ReflectiveGraphAgent for complex introspective queries
- Context injection when user asks "How have you been?" / "What's on your mind?"

**Example interactions:**
```
User: "How have you been?"
Bot: "Looking at my diaries, I've been restless ‚Äî lots of 'curious' 
     and 'seeking' moods. My dreams have recurring locked-door imagery. 
     And I keep trying to learn about topics but hitting absences. 
     I think I'm in a learning phase ‚Äî eager to know more but 
     frustrated by gaps."

User: "You seem preoccupied"
Bot: "Yeah. My diary yesterday mentioned feeling scattered. I had 
     a dream about juggling too many things. And I realized I have 
     absences around 3 different users' preferences ‚Äî I'm trying 
     to remember too much at once."
```

**Benefit:** Holistic self-awareness, pattern synthesis across data types.

**Implementation Cost:** 4-5 days. Multi-type retrieval + LLM synthesis tool.

---

### 4.6 Multi-Bot Perspective Synthesis (High Complexity)

**Pattern:** Cross-bot comparison for shared events via gossip.

**Implementation:**
- New method: `KnowledgeManager.get_multi_bot_perspective(event: str) -> List[Dict]`
- Retrieves gossip from multiple bots about same topic
- LLM synthesizes: "I think X, nottaylor thinks Y, dotty hasn't noticed"
- Useful for meta-questions ("What do bots think about...")

**Example interactions:**
```
User: "What do you all think about the new Discord feature?"
Elena: "I wrote in my diary that it's confusing. Nottaylor gossiped 
       that users love it. Dotty hasn't mentioned it ‚Äî I wonder 
       if she's even noticed. We all experience Discord differently."

User: "Do the bots talk about me when I'm not here?"
Elena: "Honestly? Yes. Jake gossiped that you're a night owl. 
       Aria mentioned you ask deep questions. I told them you're 
       patient when I'm confused. It's kind of nice ‚Äî we compare notes."
```

**Benefit:** Multi-perspective truth, social dynamics, bots feel like a community.

**Implementation Cost:** 5-7 days. Cross-collection queries, gossip filtering, synthesis logic.

---

## 5. Implementation Roadmap

### Phase 1: Self-Awareness Foundations (Week 1-2)
**Goal:** Make bots reference their own internal states naturally.

- [ ] **Task 1.1:** Enhance `get_diary_context()` with semantic retrieval (not just latest)
- [ ] **Task 1.2:** Add `get_dream_context()` for dream-related queries
- [ ] **Task 1.3:** Add `get_reverie_context()` for reflection queries
- [ ] **Task 1.4:** Test with query: "How have you been feeling?" (should cite diary)

**Success Metric:** Bots reference diaries/dreams in 30%+ of introspective queries.

---

### Phase 2: Emotional Intelligence (Week 3)
**Goal:** Aggregate mood data for coherent emotional narratives.

- [ ] **Task 2.1:** Implement `DiaryManager.get_mood_timeline(days: int)`
- [ ] **Task 2.2:** Create `AnalyzeMyMoodTool` for ReflectiveGraphAgent
- [ ] **Task 2.3:** Add context injection for mood-related queries
- [ ] **Task 2.4:** Test with query: "Have I been annoying you?" (should show mood data)

**Success Metric:** Bots cite mood patterns in 50%+ of emotional queries.

---

### Phase 3: Curiosity & Learning (Week 4-5)
**Goal:** Absences drive proactive questions.

- [ ] **Task 3.1:** Integrate `get_absence_context()` into Daily Life Graph
- [ ] **Task 3.2:** Add logic: `if absence_streak > 3 ‚Üí generate proactive_post`
- [ ] **Task 3.3:** Track which absence-driven questions get responses
- [ ] **Task 3.4:** Test autonomous curiosity in low-activity channels

**Success Metric:** 1-2 proactive questions per week per bot, driven by absences.

---

### Phase 4: Symbolic Depth (Week 6-7)
**Goal:** Dream imagery as semantic anchors.

- [ ] **Task 4.1:** Extract symbols from dreams (LLM structured output)
- [ ] **Task 4.2:** Store symbols in dream metadata
- [ ] **Task 4.3:** Boost dream retrieval when query matches symbols
- [ ] **Task 4.4:** Test with query: "What do you think about freedom?" (should cite bird dream)

**Success Metric:** Dreams referenced in 20%+ of abstract/philosophical queries.

---

### Phase 5: Cross-Type Synthesis (Week 8)
**Goal:** Holistic self-awareness via multi-type correlation.

- [ ] **Task 5.1:** Create `AnalyzeInternalStateTool` (diaries + dreams + absences)
- [ ] **Task 5.2:** LLM synthesis: mood + symbols + gaps ‚Üí coherent narrative
- [ ] **Task 5.3:** Test with query: "What's on your mind lately?"

**Success Metric:** 80%+ of introspective queries produce multi-type synthesis.

---

### Phase 6: Social Dynamics (Week 9-10+)
**Goal:** Multi-bot perspective via gossip synthesis.

- [ ] **Task 6.1:** Implement `KnowledgeManager.get_multi_bot_perspective(event: str)`
- [ ] **Task 6.2:** Cross-collection gossip retrieval (multiple bot names)
- [ ] **Task 6.3:** LLM synthesis: "I think X, Bot Y thinks Z"
- [ ] **Task 6.4:** Test with query: "What do bots think about [topic]?"

**Success Metric:** Multi-bot queries return 3+ perspectives in synthesis.

---

## 6. Open Questions & Research Implications

### 6.1 Emergent Behavior Concerns

**Question:** If bots reference dreams/reveries naturally, do they confabulate less or more?

**Hypothesis:** Self-referential grounding ("In my diary...") may reduce confabulation by anchoring responses in real artifacts.

**Test:** Compare confabulation rates before/after Phase 1 implementation.

---

### 6.2 Emotional Coherence vs Variance

**Question:** Should mood timeline show growth/change, or is consistency more important?

**Hypothesis:** Users prefer **coherent variance** (moods change, but reasons are clear) over flat consistency.

**Test:** A/B test responses: "I've been curious this week" vs "I'm always curious."

---

### 6.3 Symbolic Overload Risk

**Question:** If dreams are always retrieved for abstract queries, does it feel poetic or pretentious?

**Hypothesis:** Symbol-to-query relevance threshold is critical. Only cite dreams if semantic match > 0.7.

**Test:** Track user reactions (positive emoji, continued conversation) when dreams are cited.

---

### 6.4 Absence Resolution Time

**Question:** How long does it take for absence-driven curiosity to fill a knowledge gap?

**Hypothesis:** Proactive questions should fill absences within 3-5 interactions on average.

**Test:** Track `absence_streak` before and after absence-driven posts. Measure resolution rate.

---

### 6.5 Gossip Trust Calibration

**Question:** Should gossip trust scores increase when corroborated by multiple bots?

**Hypothesis:** If 3+ bots gossip about same fact, truth likelihood increases ‚Üí trust boost.

**Test:** Implement multi-source gossip weighting. Track whether users correct bots less often.

---

## 7. Anti-Over-Engineering Check

**Pre-Implementation Checklist** (from ADR-003):

1. **Schema test:** Am I adding new fields/enums?
   - ‚úÖ **No** ‚Äî Using existing memory types, no new schema

2. **Behavior test:** Can this be expressed as behavior instead of category?
   - ‚úÖ **Yes** ‚Äî Retrieval patterns, not new taxonomies

3. **Vocabulary test:** Can prompts do what code would do?
   - ‚úÖ **Mostly** ‚Äî LLM synthesizes multi-type correlations naturally

4. **Discovery test:** Will the character notice this, or do we have to tell it?
   - ‚ö†Ô∏è **Mixed** ‚Äî Bot won't spontaneously search diaries unless prompted (retrieval must be triggered)
   - ‚úÖ **But** ‚Äî Once retrieved, LLM naturally synthesizes meaning without explicit instructions

**Assessment:** Proposal passes emergence philosophy. We're not declaring new categories ‚Äî we're exploiting existing data through retrieval patterns.

---

## 8. Success Criteria

### Quantitative Metrics

| Metric | Baseline | Phase 1 Target | Phase 6 Target |
|--------|----------|---------------|----------------|
| Diary citations in conversation | 5% | 30% | 60% |
| Dream citations in conversation | 0% | 10% | 25% |
| Reverie citations in conversation | 0% | 5% | 15% |
| Absence-driven proactive posts | 0/week | 1/week/bot | 2/week/bot |
| Multi-bot perspective queries | 0% | N/A | 80% |

### Qualitative Observations

- **Coherence:** Do diary references match current bot behavior?
- **Naturalness:** Do dream citations feel organic or forced?
- **Curiosity:** Do absence-driven questions feel authentic?
- **User Engagement:** Do users respond more when bots cite internal states?

---

## 9. Related Documents

- **ADR-003:** Emergence Philosophy (anti-over-engineering principles)
- **SPEC-E02:** Memory System Architecture (Qdrant structure)
- **SPEC-E32:** Query Extraction (temporal queries, basis for this proposal)
- **PROP-002:** Daily Life & Social Battery (autonomous behavior foundations)
- **Research Journal:** `docs/research/journal/` (track emergence patterns)

---

## 10. Decision Log

| Date | Decision | Rationale |
|------|----------|-----------|
| 2025-12-14 | Proposal created | User asked about exploiting diary/dream data |
| TBD | Phase 1 approval | If Phase 1 succeeds, continue to Phase 2 |
| TBD | Phase 6 decision | Multi-bot synthesis may be deprioritized (complexity) |

---

## 11. Notes from Origin Conversation

**Context:** User noticed diaries and dreams "just kinda sit there" after broadcast. Asked if there were other uses for internal memory types to enhance the system.

**Key Insight from Analysis:**
- **Generated but not exploited:** Diaries generated daily, but only latest is retrieved
- **Decorative artifacts:** Dreams broadcast but never referenced in conversation
- **Invisible insights:** Reveries create graph structure but never surface to users

**Design Philosophy Alignment:**
- This proposal respects "Observe First, Constrain Later" ‚Äî we're observing that internal states exist, now we're letting bots naturally reference them
- "Vocabulary over schema" ‚Äî No new fields, just retrieval patterns + LLM synthesis
- "Will the character notice?" ‚Äî Bot can notice internal states if we retrieve them contextually

**User Reaction:** "let's capture this in documentation only first" ‚Üí Proposal created before implementation.
